async function r(e){try{await chrome.scripting.insertCSS({target:{tabId:e},files:["assets/main.css"]}),console.log("CSS injected!");const s=await chrome.scripting.executeScript({target:{tabId:e},files:["app.js"]});if(console.log(s),(await i(e,{})).loaded==="true")return e}catch(s){console.error("Error injecting CSS or executing script:",s)}}async function i(e,s){return new Promise(t=>{chrome.tabs.sendMessage(e,s,c=>t(c))})}const n=new Set;let o;chrome.action.onClicked.addListener(async function(e){if(n.has(e.id))(await i(e.id,{action:"close"})).status==="closed"&&n.delete(e.id);else if(o)(await i(e.id,{action:"open"})).status==="opened"&&n.add(e.id);else{o=!0;const s=await r(e.id);n.add(s)}});
