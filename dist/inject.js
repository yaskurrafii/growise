async function r(e){try{await chrome.scripting.insertCSS({target:{tabId:e},files:["assets/main.css"]}),console.log("CSS injected!");const s=await chrome.scripting.executeScript({target:{tabId:e},files:["app.js"]});console.log(s);const n=await o(e,{action:"init"});if(console.log(n),n.status==="opened")return e}catch(s){console.error("Error injecting CSS or executing script:",s)}}async function o(e,s){return new Promise(n=>{chrome.tabs.sendMessage(e,s,c=>n(c))})}const i=new Set;let t;chrome.action.onClicked.addListener(async function(e){if(console.log(e),i.has(e.id))(await o(e.id,{action:"close"})).status==="closed"&&i.delete(e.id);else if(t)(await o(e.id,{action:"open"})).status==="opened"&&i.add(e.id);else{t=!0;const s=await r(e.id);i.add(s)}});
